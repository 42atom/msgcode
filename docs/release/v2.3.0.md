# v2.3.0 发布说明

发布日期：2026-02-17

## 版本概述

v2.3.0 是 P4.x 里程碑的核心发布，包含 Slash 命令收敛、SOUL 市场、Persona 退役等重大架构变更。

## 主要变更

### P4.3: Slash 命令收敛

- 建立单一命令注册表（SSOT），所有命令从注册表渲染
- 用户可见命令收敛为 12 条主命令，长尾改 alias 或子命令
- `/help` 输出与注册表 100% 一致
- 未知命令提示也从注册表获取

### P4.1: SOUL Mod Market

- 三层架构：激活映射层（active.ts）+ 安装逻辑层（market.ts）+ 加载器层（loader.ts）
- `msgcode soul list` - 列出已安装人格
- `msgcode soul install <id>` - 从市场安装人格
- `msgcode soul use <id>` - 激活人格
- `msgcode soul rollback` - 回滚到上一版本
- PI debug 输出增加 activeSoulId / activeSoulVersion

### P4.4: Persona 退役

- 移除 persona 主流程依赖，统一进入 SOUL 体系
- 保留 `/persona` 兼容提示壳（明确提示“已退役，请使用 /soul”）

### P4.3-R1: Bugfix

- 修复 /soul 命令黑洞（之前被识别但不处理）
- 修复 schedule 别名冲突（schedule 现在是独立命令）
- 未知命令提示改为从注册表动态获取

## 迁移提示

### 必须迁移

1. **/persona 已退役**：统一使用 `/soul` 命令管理人格
   - `/persona list` → `/soul list`
   - `/persona use <id>` → `/soul use <id>`

2. **/soul 已纳入主命令路径**：不再黑洞，现在可正常使用

3. **schedule 保持独立命令**：不再作为 soul 别名
   - `/schedule list` 保持不变
   - `/soul list` 现在等价于 `/schedule list`

## 用户可见命令清单（12 条）

| 命令 | 说明 |
|------|------|
| `/start` | 启动/停止会话 |
| `/status` | 查看当前状态 |
| `/bind` | 绑定工作区 |
| `/where` | 查看当前工作区 |
| `/unbind` | 解除工作区绑定 |
| `/model` | 查看或切换模型 |
| `/mode` | 切换响应模式 |
| `/tts` | 文字转语音 |
| `/voice` | 语音交互 |
| `/soul` | 人格与定时任务 |
| `/help` | 显示帮助（真相源） |
| `/info` | 查看处理状态 |

## 固定验收

```bash
npx tsc --noEmit
npm test
npm run docs:check
```

## 风险与回滚

### 已知非阻塞项

- 无

### 回滚步骤

```bash
# 回滚版本号
git checkout package.json

# 回滚命令注册表
git checkout src/commands/registry.ts
git checkout src/routes/commands.ts
```

## 感谢

感谢所有参与 P4.x 里程碑开发和测试的贡献者。
